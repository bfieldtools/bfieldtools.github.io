<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Example of designing a shielded biplanar coil &#8212; bfieldtools  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Figure 2: Surface harmonics modes" href="../publication_software/plot_suhmodes.html" />
    <link rel="prev" title="Field distortion by a perfect mu-metal shield" href="mumetal_shield_example.html" />

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-166989761-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-166989761-1');
    </script>

    <link rel="stylesheet" href="../../_static/style.css " type="text/css" />
    <link rel="stylesheet" href="../../_static/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-code-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font-source-sans-pro.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/flag-icon.css" type="text/css" />
    

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>


  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/logo_simple.png"></span>
          bfieldtools</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../overview.html">Overview</a></li>
                <li><a href="../../installation.html">Install</a></li>
                <li><a href="../../literature.html">Literature</a></li>
                <li><a href="../index.html">Examples</a></li>
                <li><a href="../../api_reference.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#documentation">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#installing-bfieldtools">Installing bfieldtools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#citing-bfieldtools">Citing bfieldtools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#contributing">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../literature.html">Literature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../literature.html#related-software">Related software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Example gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#coil-design">Coil design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#miscellaneous-examples">Miscellaneous examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html#physics-publication-examples">Physics publication examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#software-publication-examples">Software publication examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#thermal-noise-computation">Thermal noise computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#validation">Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference.html">API Reference</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo_simple.png" alt="Logo"/>
            </a></p><ul>
<li><a class="reference internal" href="#">Example of designing a shielded biplanar coil</a></li>
</ul>

  <li>
    <a href="mumetal_shield_example.html" title="Previous Chapter: Field distortion by a perfect mu-metal shield"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Field distort...</span>
    </a>
  </li>
  <li>
    <a href="../publication_software/plot_suhmodes.html" title="Next Chapter: Figure 2: Surface harmonics modes"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Figure 2: Sur... &raquo;</span>
    </a>
  </li>
<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-publication-physics-shielding-biplanar-example-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="example-of-designing-a-shielded-biplanar-coil">
<span id="sphx-glr-auto-examples-publication-physics-shielding-biplanar-example-py"></span><h1>Example of designing a shielded biplanar coil<a class="headerlink" href="#example-of-designing-a-shielded-biplanar-coil" title="Permalink to this headline">Â¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mayavi</span> <span class="kn">import</span> <span class="n">mlab</span>
<span class="kn">import</span> <span class="nn">trimesh</span>

<span class="kn">from</span> <span class="nn">bfieldtools.mesh_conductor</span> <span class="kn">import</span> <span class="n">MeshConductor</span><span class="p">,</span> <span class="n">StreamFunction</span>
<span class="kn">from</span> <span class="nn">bfieldtools.contour</span> <span class="kn">import</span> <span class="n">scalar_contour</span>
<span class="kn">from</span> <span class="nn">bfieldtools.viz</span> <span class="kn">import</span> <span class="n">plot_3d_current_loops</span>
<span class="kn">from</span> <span class="nn">bfieldtools.utils</span> <span class="kn">import</span> <span class="n">load_example_mesh</span><span class="p">,</span> <span class="n">combine_meshes</span>


<span class="c1"># Set unit, e.g. meter or millimeter.</span>
<span class="c1"># This doesn&#39;t matter, the problem is scale-invariant</span>
<span class="n">scaling_factor</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="c1"># Load simple plane mesh that is centered on the origin</span>
<span class="n">planemesh</span> <span class="o">=</span> <span class="n">load_example_mesh</span><span class="p">(</span><span class="s2">&quot;10x10_plane_hires&quot;</span><span class="p">)</span>
<span class="n">planemesh</span><span class="o">.</span><span class="n">apply_scale</span><span class="p">(</span><span class="n">scaling_factor</span><span class="p">)</span>

<span class="c1"># Specify coil plane geometry</span>
<span class="n">center_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">scaling_factor</span>
<span class="n">standoff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">scaling_factor</span>

<span class="c1"># Create coil plane pairs</span>
<span class="n">coil_plus</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">Trimesh</span><span class="p">(</span>
    <span class="n">planemesh</span><span class="o">.</span><span class="n">vertices</span> <span class="o">+</span> <span class="n">center_offset</span> <span class="o">+</span> <span class="n">standoff</span><span class="p">,</span> <span class="n">planemesh</span><span class="o">.</span><span class="n">faces</span><span class="p">,</span> <span class="n">process</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">coil_minus</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">Trimesh</span><span class="p">(</span>
    <span class="n">planemesh</span><span class="o">.</span><span class="n">vertices</span> <span class="o">+</span> <span class="n">center_offset</span> <span class="o">-</span> <span class="n">standoff</span><span class="p">,</span> <span class="n">planemesh</span><span class="o">.</span><span class="n">faces</span><span class="p">,</span> <span class="n">process</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">mesh1</span> <span class="o">=</span> <span class="n">combine_meshes</span><span class="p">((</span><span class="n">coil_minus</span><span class="p">,</span> <span class="n">coil_plus</span><span class="p">))</span>
<span class="n">mesh2</span> <span class="o">=</span> <span class="n">mesh1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">mesh2</span><span class="o">.</span><span class="n">apply_scale</span><span class="p">(</span><span class="mf">1.4</span><span class="p">)</span>

<span class="n">coil1</span> <span class="o">=</span> <span class="n">MeshConductor</span><span class="p">(</span><span class="n">mesh_obj</span><span class="o">=</span><span class="n">mesh1</span><span class="p">,</span> <span class="n">basis_name</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">N_sph</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">coil2</span> <span class="o">=</span> <span class="n">MeshConductor</span><span class="p">(</span><span class="n">mesh_obj</span><span class="o">=</span><span class="n">mesh2</span><span class="p">,</span> <span class="n">basis_name</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">N_sph</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">M11</span> <span class="o">=</span> <span class="n">coil1</span><span class="o">.</span><span class="n">inductance</span>
<span class="n">M22</span> <span class="o">=</span> <span class="n">coil2</span><span class="o">.</span><span class="n">inductance</span>
<span class="n">M21</span> <span class="o">=</span> <span class="n">coil2</span><span class="o">.</span><span class="n">mutual_inductance</span><span class="p">(</span><span class="n">coil1</span><span class="p">)</span>
<span class="c1"># Mapping from I1 to I2, constraining flux through mesh2 to zero</span>
<span class="n">P</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">M22</span><span class="p">,</span> <span class="n">M21</span><span class="p">)</span>

<span class="n">A1</span><span class="p">,</span> <span class="n">Beta1</span> <span class="o">=</span> <span class="n">coil1</span><span class="o">.</span><span class="n">sph_couplings</span>
<span class="n">A2</span><span class="p">,</span> <span class="n">Beta2</span> <span class="o">=</span> <span class="n">coil2</span><span class="o">.</span><span class="n">sph_couplings</span>

<span class="c1"># Use lines below to get coulings with different normalization</span>
<span class="c1"># from bfieldtools.sphtools import compute_sphcoeffs_mesh</span>
<span class="c1"># A1, Beta1 = compute_sphcoeffs_mesh(mesh1, 5, normalization=&#39;energy&#39;, R=1)</span>
<span class="c1"># A2, Beta2 = compute_sphcoeffs_mesh(mesh2, 5, normalization=&#39;energy&#39;, R=1)</span>

<span class="c1"># Beta1 = Beta1[:, coil1.inner_vertices]</span>
<span class="c1"># Beta2 = Beta2[:, coil2.inner_vertices]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>  <span class="c1"># 150)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s2">&quot;ij&quot;</span><span class="p">)</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>


<span class="n">CB1</span> <span class="o">=</span> <span class="n">coil1</span><span class="o">.</span><span class="n">B_coupling</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="n">CB2</span> <span class="o">=</span> <span class="n">coil2</span><span class="o">.</span><span class="n">B_coupling</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

<span class="n">CU1</span> <span class="o">=</span> <span class="n">coil1</span><span class="o">.</span><span class="n">U_coupling</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="n">CU2</span> <span class="o">=</span> <span class="n">coil2</span><span class="o">.</span><span class="n">U_coupling</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing the inductance matrix...
Computing self-inductance matrix using rough quadrature (degree=2).              For higher accuracy, set quad_degree to 4 or more.
Estimating 34964 MiB required for 3184 by 3184 vertices...
Computing inductance matrix in 60 chunks (12500 MiB memory free),              when approx_far=True using more chunks is faster...
Computing triangle-coupling matrix
Inductance matrix computation took 12.91 seconds.
Computing the inductance matrix...
Computing self-inductance matrix using rough quadrature (degree=2).              For higher accuracy, set quad_degree to 4 or more.
Estimating 34964 MiB required for 3184 by 3184 vertices...
Computing inductance matrix in 60 chunks (12289 MiB memory free),              when approx_far=True using more chunks is faster...
Computing triangle-coupling matrix
Inductance matrix computation took 13.15 seconds.
Estimating 34964 MiB required for 3184 by 3184 vertices...
Computing inductance matrix in 60 chunks (12118 MiB memory free),              when approx_far=True using more chunks is faster...
Computing triangle-coupling matrix
Computing coupling matrices
l = 1 computed
l = 2 computed
l = 3 computed
l = 4 computed
Computing coupling matrices
l = 1 computed
l = 2 computed
l = 3 computed
l = 4 computed
Computing magnetic field coupling matrix, 3184 vertices by 2500 target points... took 1.80 seconds.
Computing magnetic field coupling matrix, 3184 vertices by 2500 target points... took 1.80 seconds.
Computing scalar potential coupling matrix, 3184 vertices by 2500 target points... took 8.65 seconds.
Computing scalar potential coupling matrix, 3184 vertices by 2500 target points... took 8.68 seconds.
</pre></div>
</div>
<p>alpha[15] = 1
Minimization of magnetic energy with spherical harmonic constraint</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">Beta1</span> <span class="o">+</span> <span class="n">Beta2</span> <span class="o">@</span> <span class="n">P</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">M11</span> <span class="o">+</span> <span class="n">M21</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">P</span>

<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">eigvalsh</span>

<span class="n">ssmax</span> <span class="o">=</span> <span class="n">eigvalsh</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">C</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">eigvals</span><span class="o">=</span><span class="p">[</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Beta1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">beta</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Gradient</span>
<span class="c1"># beta[2] = 1  # Homogeneous</span>

<span class="c1"># Minimum residual</span>
<span class="n">_lambda</span> <span class="o">=</span> <span class="mf">1e3</span>
<span class="c1"># Minimum energy</span>
<span class="c1"># _lambda=1e-3</span>
<span class="n">I1inner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">C</span> <span class="o">+</span> <span class="n">M</span> <span class="o">*</span> <span class="n">ssmax</span> <span class="o">/</span> <span class="n">_lambda</span><span class="p">,</span> <span class="n">C</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">beta</span><span class="p">)</span>

<span class="n">I2inner</span> <span class="o">=</span> <span class="n">P</span> <span class="o">@</span> <span class="n">I1inner</span>

<span class="n">s1</span> <span class="o">=</span> <span class="n">StreamFunction</span><span class="p">(</span><span class="n">I1inner</span><span class="p">,</span> <span class="n">coil1</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">StreamFunction</span><span class="p">(</span><span class="n">I2inner</span><span class="p">,</span> <span class="n">coil2</span><span class="p">)</span>

<span class="c1"># s = mlab.triangular_mesh(*mesh1.vertices.T, mesh1.faces, scalars=I1)</span>
<span class="c1"># s.enable_contours=True</span>
<span class="c1"># s = mlab.triangular_mesh(*mesh2.vertices.T, mesh2.faces, scalars=I2)</span>
<span class="c1"># s.enable_contours=True</span>

<span class="n">B1</span> <span class="o">=</span> <span class="n">CB1</span> <span class="o">@</span> <span class="n">s1</span>
<span class="n">B2</span> <span class="o">=</span> <span class="n">CB2</span> <span class="o">@</span> <span class="n">s2</span>

<span class="n">U1</span> <span class="o">=</span> <span class="n">CU1</span> <span class="o">@</span> <span class="n">s1</span>
<span class="n">U2</span> <span class="o">=</span> <span class="n">CU2</span> <span class="o">@</span> <span class="n">s2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cc1</span> <span class="o">=</span> <span class="n">scalar_contour</span><span class="p">(</span><span class="n">mesh1</span><span class="p">,</span> <span class="n">mesh1</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">contours</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.001</span><span class="p">])</span>
<span class="n">cc2</span> <span class="o">=</span> <span class="n">scalar_contour</span><span class="p">(</span><span class="n">mesh2</span><span class="p">,</span> <span class="n">mesh2</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">contours</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.001</span><span class="p">])</span>
<span class="n">cx10</span> <span class="o">=</span> <span class="n">cc1</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">cy10</span> <span class="o">=</span> <span class="n">cc1</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">cx20</span> <span class="o">=</span> <span class="n">cc2</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">cy20</span> <span class="o">=</span> <span class="n">cc2</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">cx11</span> <span class="o">=</span> <span class="n">cc1</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">cy11</span> <span class="o">=</span> <span class="n">cc1</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">cx21</span> <span class="o">=</span> <span class="n">cc2</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">cy21</span> <span class="o">=</span> <span class="n">cc2</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">B1</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">B2</span><span class="o">.</span><span class="n">T</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">lw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">lw</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">lw</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lw</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">e</span> <span class="o">+</span> <span class="mf">1.1</span><span class="p">)</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="c1"># seed_points = 0.56*np.array([xx, -np.sqrt(1-xx**2)])</span>
<span class="c1"># seed_points = np.hstack([seed_points, (0.56*np.array([xx, np.sqrt(1-xx**2)]))])</span>
<span class="c1"># seed_points = np.hstack([seed_points, (0.56*np.array([np.zeros_like(xx), xx]))])</span>
<span class="n">seed_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cx10</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">cy10</span><span class="p">])</span>
<span class="n">seed_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">seed_points</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cx11</span> <span class="o">-</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">cy11</span><span class="p">])])</span>
<span class="n">seed_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">seed_points</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.56</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">xx</span><span class="p">]))])</span>

<span class="c1"># plt.streamplot(x,y, B[1], B[0], density=2, linewidth=lw, color=&#39;k&#39;,</span>
<span class="c1">#               start_points=seed_points.T, integration_direction=&#39;both&#39;)</span>
<span class="n">U</span> <span class="o">=</span> <span class="p">(</span><span class="n">U1</span> <span class="o">+</span> <span class="n">U2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">U</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;seismic&quot;</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="c1"># plt.imshow(U, vmin=-1.0, vmax=1.0, cmap=&#39;seismic&#39;, interpolation=&#39;bicubic&#39;,</span>
<span class="c1">#           extent=(x.min(), x.max(), y.min(), y.max()))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">density</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="n">start_points</span><span class="o">=</span><span class="n">seed_points</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
    <span class="n">integration_direction</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span>
    <span class="n">arrowsize</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># plt.plot(seed_points[0], seed_points[1], &#39;*&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cx10</span><span class="p">,</span> <span class="n">cy10</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cx20</span><span class="p">,</span> <span class="n">cy20</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cx11</span><span class="p">,</span> <span class="n">cy11</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cx21</span><span class="p">,</span> <span class="n">cy21</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_shielding_biplanar_example_001.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_shielding_biplanar_example_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>([], &lt;a list of 0 Text major ticklabel objects&gt;)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">mm</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">s1</span><span class="p">))</span>
<span class="n">dd</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">mm</span> <span class="o">/</span> <span class="n">N</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">dd</span> <span class="o">*</span> <span class="n">N</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dd</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="n">dd</span> <span class="o">*</span> <span class="n">N</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">dd</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">contour_vals1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">dd</span><span class="p">)</span>
<span class="n">mm</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">s2</span><span class="p">))</span>
<span class="n">N2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mm</span> <span class="o">-</span> <span class="n">dd</span><span class="p">)</span> <span class="o">//</span> <span class="n">dd</span>
<span class="k">if</span> <span class="n">N2</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">N2</span> <span class="o">-=</span> <span class="mi">1</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">dd</span> <span class="o">*</span> <span class="n">N2</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="n">mm</span>
<span class="n">contour_vals2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">dd</span><span class="p">)</span>
<span class="n">contours1</span> <span class="o">=</span> <span class="n">scalar_contour</span><span class="p">(</span><span class="n">mesh1</span><span class="p">,</span> <span class="n">s1</span><span class="o">.</span><span class="n">vert</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="n">contour_vals1</span><span class="p">)</span>
<span class="n">contours2</span> <span class="o">=</span> <span class="n">scalar_contour</span><span class="p">(</span><span class="n">mesh2</span><span class="p">,</span> <span class="n">s2</span><span class="o">.</span><span class="n">vert</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="n">contour_vals2</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">setscene</span><span class="p">(</span><span class="n">scene1</span><span class="p">,</span> <span class="n">coil</span><span class="p">):</span>
    <span class="n">scene1</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mapper</span><span class="o">.</span><span class="n">interpolate_scalars_before_mapping</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">scene1</span><span class="o">.</span><span class="n">module_manager</span><span class="o">.</span><span class="n">scalar_lut_manager</span><span class="o">.</span><span class="n">number_of_colors</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">y_plus_view</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">coil</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="p">[</span>
            <span class="mf">4.7267030067743576e-08</span><span class="p">,</span>
            <span class="mf">2.660205137153174</span><span class="p">,</span>
            <span class="mf">8.52196480605194e-08</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">focal_point</span> <span class="o">=</span> <span class="p">[</span>
            <span class="mf">4.7267030067743576e-08</span><span class="p">,</span>
            <span class="mf">0.4000000059604645</span><span class="p">,</span>
            <span class="mf">8.52196480605194e-08</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">view_angle</span> <span class="o">=</span> <span class="mf">30.0</span>
        <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">view_up</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">clipping_range</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.116284842928313</span><span class="p">,</span> <span class="mf">2.4468228732691104</span><span class="p">]</span>
        <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">compute_view_plane_normal</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="p">[</span>
            <span class="mf">4.7267030067743576e-08</span><span class="p">,</span>
            <span class="mf">3.7091663385397116</span><span class="p">,</span>
            <span class="mf">8.52196480605194e-08</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">focal_point</span> <span class="o">=</span> <span class="p">[</span>
            <span class="mf">4.7267030067743576e-08</span><span class="p">,</span>
            <span class="mf">0.4000000059604645</span><span class="p">,</span>
            <span class="mf">8.52196480605194e-08</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">view_angle</span> <span class="o">=</span> <span class="mf">30.0</span>
        <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">view_up</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
        <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">clipping_range</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.948955346473114</span><span class="p">,</span> <span class="mf">3.40878670176758</span><span class="p">]</span>
        <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">compute_view_plane_normal</span><span class="p">()</span>
    <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
    <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">anti_aliasing_frames</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">scene1</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">magnification</span> <span class="o">=</span> <span class="mi">2</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_3d_current_loops</span><span class="p">(</span>
    <span class="n">contours1</span><span class="p">,</span> <span class="n">tube_radius</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">),</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span>
<span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">mesh1</span><span class="o">.</span><span class="n">triangles_center</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="n">faces1</span> <span class="o">=</span> <span class="n">mesh1</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">surf</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">triangular_mesh</span><span class="p">(</span>
    <span class="o">*</span><span class="n">mesh1</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">faces1</span><span class="p">,</span> <span class="n">scalars</span><span class="o">=</span><span class="n">s1</span><span class="o">.</span><span class="n">vert</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">m</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s2">&quot;seismic&quot;</span>
<span class="p">)</span>
<span class="n">setscene</span><span class="p">(</span><span class="n">surf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_3d_current_loops</span><span class="p">(</span>
    <span class="n">contours2</span><span class="p">,</span> <span class="n">tube_radius</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">),</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span>
<span class="p">)</span>
<span class="n">faces2</span> <span class="o">=</span> <span class="n">mesh2</span><span class="o">.</span><span class="n">faces</span><span class="p">[</span><span class="n">mesh2</span><span class="o">.</span><span class="n">triangles_center</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">surf</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">triangular_mesh</span><span class="p">(</span>
    <span class="o">*</span><span class="n">mesh2</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">faces2</span><span class="p">,</span> <span class="n">scalars</span><span class="o">=</span><span class="n">s2</span><span class="o">.</span><span class="n">vert</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">m</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s2">&quot;seismic&quot;</span>
<span class="p">)</span>
<span class="n">setscene</span><span class="p">(</span><span class="n">surf</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../../_images/sphx_glr_shielding_biplanar_example_002.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_shielding_biplanar_example_002.png" />
</li>
<li><img alt="../../_images/sphx_glr_shielding_biplanar_example_003.png" class="sphx-glr-multi-img" src="../../_images/sphx_glr_shielding_biplanar_example_003.png" />
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">surf</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">triangular_mesh</span><span class="p">(</span><span class="o">*</span><span class="n">mesh1</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">mesh1</span><span class="o">.</span><span class="n">faces</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">))</span>
<span class="n">surf</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">property</span><span class="o">.</span><span class="n">edge_visibility</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">surf</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">property</span><span class="o">.</span><span class="n">render_lines_as_tubes</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">surf</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">property</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="mf">1.2</span>


<span class="n">surf</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">triangular_mesh</span><span class="p">(</span><span class="o">*</span><span class="n">mesh2</span><span class="o">.</span><span class="n">vertices</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">mesh2</span><span class="o">.</span><span class="n">faces</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">))</span>
<span class="n">surf</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">property</span><span class="o">.</span><span class="n">edge_visibility</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">surf</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">property</span><span class="o">.</span><span class="n">render_lines_as_tubes</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">surf</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">property</span><span class="o">.</span><span class="n">line_width</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="c1"># Plot plane</span>
<span class="n">plane</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">triangular_mesh</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span>
    <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_shielding_biplanar_example_004.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_shielding_biplanar_example_004.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  31.154 seconds)</p>
<p><strong>Estimated memory usage:</strong>  2077 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-publication-physics-shielding-biplanar-example-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/324eb273fbafe3175f437c8470d57973/shielding_biplanar_example.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">shielding_biplanar_example.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/748af7e9b12b9922a41e2ab745e90f54/shielding_biplanar_example.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">shielding_biplanar_example.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


    </div>
    
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2019-2020, bfieldtools developers. Last updated on 2020-08-13.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>